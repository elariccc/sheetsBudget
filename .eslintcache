[{"D:\\React\\excel\\src\\index.js":"1","D:\\React\\excel\\src\\containers\\menuBar\\index.js":"2","D:\\React\\excel\\src\\containers\\googleAuth\\index.js":"3","D:\\React\\excel\\src\\containers\\app\\index.js":"4","D:\\React\\excel\\src\\containers\\popup\\index.js":"5","D:\\React\\excel\\src\\constants\\index.js":"6","D:\\React\\excel\\src\\components\\modal\\index.js":"7","D:\\React\\excel\\src\\components\\textInput\\index.js":"8","D:\\React\\excel\\src\\components\\layout\\index.js":"9","D:\\React\\excel\\src\\errors\\index.js":"10"},{"size":191,"mtime":1611911634224,"results":"11","hashOfConfig":"12"},{"size":761,"mtime":1611919469000,"results":"13","hashOfConfig":"12"},{"size":2927,"mtime":1611920128409,"results":"14","hashOfConfig":"12"},{"size":352,"mtime":1611913807693,"results":"15","hashOfConfig":"12"},{"size":4735,"mtime":1611920168410,"results":"16","hashOfConfig":"12"},{"size":451,"mtime":1611911079341,"results":"17","hashOfConfig":"12"},{"size":739,"mtime":1611918495035,"results":"18","hashOfConfig":"12"},{"size":1351,"mtime":1611922271568,"results":"19","hashOfConfig":"12"},{"size":1015,"mtime":1611918577942,"results":"20","hashOfConfig":"12"},{"size":89,"mtime":1611911116781,"results":"21","hashOfConfig":"12"},{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"13tzaj9",{"filePath":"24","messages":"25","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"26","messages":"27","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"30","messages":"31","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32","usedDeprecatedRules":"33"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"38","messages":"39","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},"D:\\React\\excel\\src\\index.js",[],"D:\\React\\excel\\src\\containers\\menuBar\\index.js",[],"D:\\React\\excel\\src\\containers\\googleAuth\\index.js",["44"],"D:\\React\\excel\\src\\containers\\app\\index.js",[],"D:\\React\\excel\\src\\containers\\popup\\index.js",["45"],"import React, { useEffect, useMemo, useState } from 'react';\r\n\r\nimport {gapi} from 'gapi-script';\r\n\r\nimport Modal from '../../components/modal/index';\r\nimport TextInput from '../../components/textInput/index';\r\nimport { UrlError, TemplateError } from '../../errors/index';\r\n\r\nimport { TEMPLATE_KEY } from '../../constants/index';\r\n\r\nimport './index.css';\r\n\r\nexport default function Popup(\r\n  {\r\n    authState,\r\n    googleAuthState,\r\n    openedState,\r\n    userInfo,\r\n  }\r\n) {\r\n  const [ sheetUrl, setSheetUrl ] = useState(null);\r\n  const sheetUrlState = useMemo (\r\n    () => (\r\n      {\r\n        value: sheetUrl,\r\n        set: setSheetUrl,\r\n      }\r\n    ),\r\n    [sheetUrl, setSheetUrl]\r\n  )\r\n\r\n  const [ attachingError, setAttachingError ] = useState(null);\r\n\r\n  useEffect(\r\n    () => {\r\n      if (!openedState.value) setAttachingError(null);\r\n    },\r\n    [openedState.value]\r\n  )\r\n\r\n  const handleLogOutClick = () => {\r\n    googleAuthState.value.signOut();\r\n    openedState.set(false);\r\n  };\r\n\r\n  const handleRevokeAccessClick = () => {\r\n    googleAuthState.value.disconnect();\r\n    openedState.set(false);\r\n  };\r\n\r\n  const handleAttachClick = async () => {\r\n    try {\r\n      const indexLeft = sheetUrl.indexOf('docs.google.com/spreadsheets/d/') + 'docs.google.com/spreadsheets/d/'.length;\r\n      \r\n      if (indexLeft === 30) throw (new UrlError('The given URL is not valid'));\r\n      \r\n      const leftCuttedUrl = sheetUrl.slice(indexLeft);\r\n      const indexRight = leftCuttedUrl.indexOf('/');\r\n      const sheetId = leftCuttedUrl.slice(0, indexRight > 0 ? indexRight : undefined);\r\n  \r\n      authState.sheetId.set(sheetId);\r\n\r\n      const response = await gapi.client.sheets.spreadsheets.values.get({\r\n        spreadsheetId: sheetId,\r\n        range: \"'Сводная таблица'!I20\",\r\n        valueRenderOption: 'UNFORMATTED_VALUE',\r\n        dateTimeRenderOption: 'FORMATTED_STRING',\r\n      });\r\n\r\n      const fetchedTemplateKey = response.result.values[0][0];\r\n\r\n      if (fetchedTemplateKey !== TEMPLATE_KEY) {\r\n        throw new TemplateError('Spreadsheet is not found');\r\n      }\r\n\r\n      setAttachingError(null);\r\n    } catch (error) {\r\n      setAttachingError(error);\r\n      authState.sheetId.set(null);\r\n    }\r\n  }\r\n\r\n  const handleFetchClick = async () => {\r\n    try {\r\n      const response = await gapi.client.sheets.spreadsheets.values.get({\r\n        spreadsheetId: '1MenH8sjNj5_lDjbQClo15lQ4W2Q_PZmTIX9_m_ogNuc',\r\n        range: \"'Бюджет'!A1\",\r\n        valueRenderOption: 'UNFORMATTED_VALUE',\r\n        dateTimeRenderOption: 'FORMATTED_STRING',\r\n      });\r\n\r\n      const range = response.result;\r\n\r\n      console.log(range);\r\n\r\n      const newRange = {\r\n        values: [[2]],\r\n      };\r\n\r\n      const result = await gapi.client.sheets.spreadsheets.values.update({\r\n        spreadsheetId: '1MenH8sjNj5_lDjbQClo15lQ4W2Q_PZmTIX9_m_ogNuc',\r\n        range: \"'Бюджет'!A1\",\r\n        valueInputOption: 'RAW',\r\n        resource: newRange,\r\n      });\r\n\r\n      console.log(result);\r\n    } catch (response) {\r\n      console.log(response);\r\n    }\r\n  };\r\n\r\n  const attachStatus = \r\n    authState.sheetId.value ?\r\n      <p className='attach-status green-text text-darken-3'>\r\n        Spreadsheet is successfully attached\r\n      </p>\r\n    :\r\n      attachingError ?\r\n        <p className='attach-status red-text text-darken-3'>\r\n          {attachingError.message}\r\n        </p>\r\n      :\r\n        null\r\n  ;\r\n\r\n  return (\r\n    <Modal \r\n      className='bar__popup card green lighten-5 fade-in__top-right'\r\n      openedState={openedState}\r\n      layoutOpacity='0'\r\n    >\r\n      <div className='card-content'>\r\n        <div className='popup__account'>\r\n          <img \r\n            src={userInfo.imageUrl} \r\n            alt='User pic'\r\n            className='popup__user-image'\r\n          />\r\n          <p>\r\n            {userInfo.name}\r\n          </p>\r\n          <p>\r\n            {userInfo.email}\r\n          </p>\r\n          <button onClick={handleLogOutClick} className='btn-small green darken-3 z-depth-0'>\r\n            Log out\r\n          </button>\r\n          <button onClick={handleRevokeAccessClick} className='btn-small green darken-3 z-depth-0'> \r\n            Revoke access\r\n          </button>\r\n        </div>\r\n        <hr/>\r\n        <div className='input-container'>\r\n          <TextInput\r\n            id='popup_sheetUrl' \r\n            label='Spreadsheet URL'\r\n            inputState={sheetUrlState}\r\n            defaultValue={authState.sheetId.value}\r\n          />\r\n          <button \r\n            onClick={handleAttachClick} \r\n            className='btn-small green darken-3 z-depth-0'\r\n          >\r\n            Attach\r\n          </button>\r\n        </div>\r\n        {attachStatus}\r\n      </div>\r\n    </Modal>\r\n  );\r\n}",["46","47"],"D:\\React\\excel\\src\\constants\\index.js",[],"D:\\React\\excel\\src\\components\\modal\\index.js",[],"D:\\React\\excel\\src\\components\\textInput\\index.js",[],"D:\\React\\excel\\src\\components\\layout\\index.js",[],"D:\\React\\excel\\src\\errors\\index.js",[],{"ruleId":"48","severity":1,"message":"49","line":57,"column":5,"nodeType":"50","endLine":57,"endColumn":7,"suggestions":"51"},{"ruleId":"52","severity":1,"message":"53","line":83,"column":9,"nodeType":"54","messageId":"55","endLine":83,"endColumn":25},{"ruleId":"56","replacedBy":"57"},{"ruleId":"58","replacedBy":"59"},"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'authState.isSignedIn'. Either include it or remove the dependency array.","ArrayExpression",["60"],"no-unused-vars","'handleFetchClick' is assigned a value but never used.","Identifier","unusedVar","no-native-reassign",["61"],"no-negated-in-lhs",["62"],{"desc":"63","fix":"64"},"no-global-assign","no-unsafe-negation","Update the dependencies array to be: [authState.isSignedIn]",{"range":"65","text":"66"},[1464,1466],"[authState.isSignedIn]"]